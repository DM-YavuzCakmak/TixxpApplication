@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer;
@model List<Tixxp.Entities.Personnel.PersonnelEntity>
@{
    Layout = "~/Views/Shared/_Layout.cshtml";
    var stats = ViewBag.Stats;
}

<style>
    .personal-goals-list::-webkit-scrollbar {
        width: 6px;
    }

    .personal-goals-list::-webkit-scrollbar-thumb {
        background: #cccccc;
        border-radius: 3px;
    }

    .personal-goals-list:hover::-webkit-scrollbar-thumb {
        background: #999999;
    }

    .btn-outline-danger {
        border-color: #dc3545 !important;
        color: #dc3545 !important;
        transition: all 0.25s ease;
    }

        .btn-outline-danger:hover {
            background-color: #dc3545 !important;
            color: #fff !important;
        }
</style>

<!-- Start::app-content -->
<div class="main-content app-content">
    <div class="container-fluid">
        <!-- Page Header -->
        <div class="d-md-flex d-block align-items-center justify-content-between my-4 page-header-breadcrumb text-fixed-white">
            <h1 class="page-title fw-medium fs-18 mb-0 text-fixed-white">@Localizer["home.INDEX.HOMEPAGE"]</h1>
            <div class="ms-md-1 ms-0">
                <nav>
                    <ol class="breadcrumb mb-0">
                        <li class="breadcrumb-item active text-fixed-white" aria-current="page">@Localizer["home.INDEX.HOMEPAGE"]</li>
                    </ol>
                </nav>
            </div>
        </div>
        <!-- Page Header Close -->
        <!-- Start::row-1 -->
        <div class="row row-sm">
            <div class="col-xl-6 col-xxl-3 col-sm-12 col-lg-6 col-md-6">
                <div class="card custom-card widgets-cards bg-danger-gradient shadow-danger text-default border-0">
                    <div class="card-body py-0">
                        <div class="d-flex align-items-center">
                            <div id="total-orders"></div>
                            <div class="ms-2 mt-2">
                                <h2 class="mb-0 fs-16 text-fixed-white">@Localizer["home.INDEX.MONTHLY.OF.RESERVATION"]</h2>
                                <div class="fs-12 text-fixed-white">
                                    <i class="fe fe-arrow-up-right"></i> @((decimal)stats.MonthlyReservation.ChangePercent >= 0 ? "+" : "")@stats.MonthlyReservation.ChangePercent%
                                </div>
                            </div>
                            <h3 class="mt-3 ms-auto text-fixed-white">@stats.MonthlyReservation.Count</h3>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-6 col-xxl-3 col-sm-12 col-lg-6 col-md-6">
                <div class="card custom-card widgets-cards bg-success-gradient shadow-success text-default border-0">
                    <div class="card-body py-0">
                        <div class="d-flex align-items-center">
                            <div id="total-views"></div>
                            <div class="ms-2 mt-2">
                                <h2 class="mb-0 fs-16 text-fixed-white">@Localizer["home.INDEX.DAILY.NUMBER.RESERVATION"]</h2>
                                <div class="fs-12 text-fixed-white">
                                    <i class="fe @(stats.DailyReservation.ChangePercent >= 0 ? "fe-arrow-up-right" : "fe-arrow-down-right")"></i>
                                    @((decimal)stats.DailyReservation.ChangePercent >= 0 ? "+" : "")@stats.DailyReservation.ChangePercent%
                                </div>
                            </div>
                            <h3 class="mt-3 ms-auto text-fixed-white">@stats.DailyReservation.Count</h3>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-6 col-xxl-3 col-sm-12 col-lg-6 col-md-6">
                <div class="card custom-card widgets-cards bg-secondary-gradient shadow-secondary text-default border-0">
                    <div class="card-body py-0">
                        <div class="d-flex align-items-center">
                            <div id="total-earnings"></div>
                            <div class="ms-2 mt-2">
                                <h2 class="mb-0 fs-16 text-fixed-white">@Localizer["home.INDEX.MONTHLY.OF.TICKETS"]</h2>
                                <div class="fs-12 text-fixed-white">
                                    <i class="fe @(stats.MonthlyTicket.ChangePercent >= 0 ? "fe-arrow-up-right" : "fe-arrow-down-right")"></i>
                                    @((decimal)stats.MonthlyTicket.ChangePercent >= 0 ? "+" : "")@stats.MonthlyTicket.ChangePercent%
                                </div>
                            </div>
                            <h3 class="mt-3 ms-auto text-fixed-white">@stats.MonthlyTicket.Count</h3>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-xl-6 col-xxl-3 col-sm-12 col-lg-6 col-md-6">
                <div class="card custom-card widgets-cards bg-info-gradient shadow-info text-default border-0">
                    <div class="card-body py-0">
                        <div class="d-flex align-items-center">
                            <div id="total-comments"></div>
                            <div class="ms-2 mt-2">
                                <h2 class="mb-0 fs-16 text-fixed-white">@Localizer["home.INDEX.DAILY.OF.TICKETS"]</h2>
                                <div class="fs-12 text-fixed-white">
                                    <i class="fe @(stats.DailyTicket.ChangePercent >= 0 ? "fe-arrow-up-right" : "fe-arrow-down-right")"></i>
                                    @((decimal)stats.DailyTicket.ChangePercent >= 0 ? "+" : "")@stats.DailyTicket.ChangePercent%
                                </div>
                            </div>
                            <h3 class="mt-3 ms-auto text-fixed-white">@stats.DailyTicket.Count</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!--End::row-1 -->
        <!-- Start:: row-2 -->
        <div class="row">
            <div class="col-xxl-8 col-xl-8 col-lg-7 col-md-12 col-sm-12">
                <div class="card custom-card">
                    <div class="card-header justify-content-between flex-wrap">
                        <div class="card-title">
                            @Localizer["home.INDEX.SALES.GROWTH"]
                        </div>
                    </div>
                    <div class="card-body p-0">
                        <div id="sales-statistics" class="p-3"></div>
                    </div>
                </div>
            </div>
            <div class="col-xl-4">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">@Localizer["home.INDEX.ORDERS.STATISTICS"]</div>
                    </div>
                    <div class="card-body">
                        <div id="lineChart1" class=""></div>
                    </div>

                </div>
            </div>
        </div>
        <!-- End:: row-2 -->
        <!-- Start:: row-3 -->
        <div class="row">
            <!-- Daily Product Sellers -->
            <div class="col-xl-3 col-md-6 col-lg-6">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">@Localizer["home.INDEX.DAILY_PRODUCT_SELLERS"]</div>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled personal-goals-list mb-0" style="max-height: 360px; overflow-y: auto;">
                            @if (ViewBag.DailySellers != null)
                            {
                                foreach (var item in ViewBag.DailySellers)
                                {
                                    <li class="mb-4">
                                        <div class="d-flex align-items-center">
                                            <span class="avatar avatar-sm text-default">
                                                <img src="@item.ProfilePhotoPath" alt="img" class="rounded-1" style="width: 32px; height: 32px; object-fit: cover;">
                                            </span>
                                            <div class="flex-fill ms-2">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span class="d-block h6 mb-1">@item.FirstName @item.LastName</span>
                                                    <span class="d-block h6">@item.TotalSales</span>
                                                </div>
                                                <div class="progress progress-animate progress-xs" role="progressbar" aria-valuenow="@item.Percent" aria-valuemin="0" aria-valuemax="100">
                                                    <div class="progress-bar progress-bar-striped bg-primary" style="width: @item.Percent%"></div>
                                                </div>
                                                <small class="text-muted">@item.Date.ToString("dd.MM.yyyy")</small>
                                            </div>
                                        </div>
                                    </li>
                                }
                            }
                            else
                            {
                                <li><span class="text-muted">Kayıt bulunamadı</span></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Monthly Product Sellers -->
            <div class="col-xl-3 col-md-6 col-lg-6">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">@Localizer["home.INDEX.MONTHLY_PRODUCT_SELLERS"]</div>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled personal-goals-list mb-0" style="max-height: 360px; overflow-y: auto;">
                            @if (ViewBag.MonthlyProductSellers != null)
                            {
                                foreach (var item in ViewBag.MonthlyProductSellers)
                                {
                                    <li class="mb-4">
                                        <div class="d-flex align-items-center">
                                            <span class="avatar avatar-sm text-default">
                                                <img src="@item.ProfilePhotoPath" alt="img" class="rounded-1" style="width: 32px; height: 32px; object-fit: cover;">
                                            </span>
                                            <div class="flex-fill ms-2">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span class="d-block h6 mb-1">@item.FirstName @item.LastName</span>
                                                    <span class="d-block h6">@item.TotalSales</span>
                                                </div>
                                                <div class="progress progress-animate progress-xs" role="progressbar" aria-valuenow="@item.Percent" aria-valuemin="0" aria-valuemax="100">
                                                    <div class="progress-bar progress-bar-striped bg-primary" style="width: @item.Percent%"></div>
                                                </div>
                                                <small class="text-muted">@item.Date.ToString("dd.MM.yyyy")</small>
                                            </div>
                                        </div>
                                    </li>
                                }
                            }
                            else
                            {
                                <li><span class="text-muted">Kayıt bulunamadı</span></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Daily Reservation Sellers -->
            <div class="col-xl-3 col-md-6 col-lg-6">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">@Localizer["home.INDEX.DAILY_RESERVATION_SELLERS"]</div>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled personal-goals-list mb-0" style="max-height: 360px; overflow-y: auto;">
                            @if (ViewBag.DailyReservationSellers != null)
                            {
                                foreach (var item in ViewBag.DailyReservationSellers)
                                {
                                    <li class="mb-4">
                                        <div class="d-flex align-items-center">
                                            <span class="avatar avatar-sm text-default">
                                                <img src="@item.ProfilePhotoPath" alt="img" class="rounded-1" style="width: 32px; height: 32px; object-fit: cover;">
                                            </span>
                                            <div class="flex-fill ms-2">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span class="d-block h6 mb-1">@item.FirstName @item.LastName</span>
                                                    <span class="d-block h6">@item.TotalSales</span>
                                                </div>
                                                <div class="progress progress-animate progress-xs" role="progressbar" aria-valuenow="@item.Percent" aria-valuemin="0" aria-valuemax="100">
                                                    <div class="progress-bar progress-bar-striped bg-success" style="width: @item.Percent%"></div>
                                                </div>
                                                <small class="text-muted">@item.Date.ToString("dd.MM.yyyy")</small>
                                            </div>
                                        </div>
                                    </li>
                                }
                            }
                            else
                            {
                                <li><span class="text-muted">Kayıt bulunamadı</span></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>

            <!-- Monthly Reservation Sellers -->
            <div class="col-xl-3 col-md-6 col-lg-6">
                <div class="card custom-card">
                    <div class="card-header">
                        <div class="card-title">@Localizer["home.INDEX.MONTHLY_RESERVATION_SELLERS"]</div>
                    </div>
                    <div class="card-body">
                        <ul class="list-unstyled personal-goals-list mb-0" style="max-height: 360px; overflow-y: auto;">
                            @if (ViewBag.MonthlyReservationSellers != null)
                            {
                                foreach (var item in ViewBag.MonthlyReservationSellers)
                                {
                                    <li class="mb-4">
                                        <div class="d-flex align-items-center">
                                            <span class="avatar avatar-sm text-default">
                                                <img src="@item.ProfilePhotoPath" alt="img" class="rounded-1" style="width: 32px; height: 32px; object-fit: cover;">
                                            </span>
                                            <div class="flex-fill ms-2">
                                                <div class="d-flex align-items-center justify-content-between">
                                                    <span class="d-block h6 mb-1">@item.FirstName @item.LastName</span>
                                                    <span class="d-block h6">@item.TotalSales</span>
                                                </div>
                                                <div class="progress progress-animate progress-xs" role="progressbar" aria-valuenow="@item.Percent" aria-valuemin="0" aria-valuemax="100">
                                                    <div class="progress-bar progress-bar-striped bg-warning" style="width: @item.Percent%"></div>
                                                </div>
                                                <small class="text-muted">@item.Date.ToString("dd.MM.yyyy")</small>
                                            </div>
                                        </div>
                                    </li>
                                }
                            }
                            else
                            {
                                <li><span class="text-muted">Kayıt bulunamadı</span></li>
                            }
                        </ul>
                    </div>
                </div>
            </div>



            <div class="col-lg-12">
                <div class="card custom-card">
                    <div class="card-header">
                        <h3 class="card-title">@Localizer["home.INDEX.SALES"]</h3>
                    </div>
                    <div class="card-body">
                        <table id="recent-sales-table" class="table table-striped table-bordered nowrap w-100">
                            <thead>
                                <tr>
                                    <th>@Localizer["home.INDEX.USER"]</th>
                                    <th>@Localizer["home.INDEX.ORDER.NO"]</th>
                                    <th>@Localizer["home.INDEX.DATE"]</th>
                                    <th>@Localizer["home.INDEX.AMOUNT"]</th>
                                    <th>@Localizer["home.INDEX.PAYMENT.PLACE"]</th>
                                    <th>@Localizer["home.INDEX.STATUS"]</th>
                                    <th>@Localizer["home.INDEX.PRODUCT_DETAIL"]</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        <div class="modal fade" id="saleDetailModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-xl modal-dialog-scrollable">
                <div class="modal-content">
                    <div class="modal-header bg-dark text-white">
                        <h5 class="modal-title text-white">@Localizer["home.INDEX.ProductSALE_DETAIL_MODAL_TITLE"]</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body p-0">
                        <div id="saleDetailContainer" class="p-3 text-center text-muted">
                            <div class="spinner-border text-warning" role="status"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

@section Scripts {
        <script>

               function cancelSale(saleId) {
                Swal.fire({
                    title: '@Localizer["productSale.DETAIL.CANCEL_CONFIRM_TITLE"]',
                    text: '@Localizer["productSale.DETAIL.CANCEL_CONFIRM_TEXT"]',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonColor: '#dc3545',
                    cancelButtonColor: '#6c757d',
                    confirmButtonText: '@Localizer["productSale.DETAIL.CONFIRM_YES"]',
                    cancelButtonText: '@Localizer["productSale.DETAIL.CONFIRM_NO"]'
                }).then((result) => {
                    if (result.isConfirmed) {
                        const culture = new URLSearchParams(window.location.search).get("culture") || "tr-TR";
                        const uiCulture = new URLSearchParams(window.location.search).get("ui-culture") || culture;

                        $.ajax({
                            url: `/Home/CancelSale?saleId=${saleId}&culture=${culture}&ui-culture=${uiCulture}`,
                            type: 'POST',
                            success: function (res) {
                                Swal.fire({
                                    icon: res.success ? 'success' : 'error',
                                    title: res.message
                                });
                                if (res.success) {
                                    $('#recent-sales-table').DataTable().ajax.reload();
                                }
                            },
                            error: function () {
                                Swal.fire({
                                    icon: 'error',
                                    title: '@Localizer["home.INDEX.ERROR_LOADING_SALE_DETAIL"]'
                                });
                            }
                        });
                    }
                });
            }



                function showSaleDetail(productSaleId) {
                const modalBody = $("#saleDetailContainer");
                modalBody.html(`<div class="text-center py-4"><div class="spinner-border text-warning" role="status"></div></div>`);
                $("#saleDetailModal").modal("show");

                // 🌍 Aktif kültür (dil) bilgisini al
                const culture = new URLSearchParams(window.location.search).get("culture") || "tr-TR";
                const uiCulture = new URLSearchParams(window.location.search).get("ui-culture") || culture;

                // 🧭 URL'e kültür parametrelerini ekle
                const url = `/Home/GetProductSaleDetail?productSaleId=${productSaleId}&culture=${culture}&ui-culture=${uiCulture}`;

                $.ajax({
                    url: url,
                    type: "GET",
                    success: function (html) {
                        modalBody.html(html);
                    },
                    error: function () {
                        modalBody.html(`<div class="alert alert-danger m-3">
                                            @Localizer["home.INDEX.ERROR_LOADING_SALE_DETAIL"]
                                        </div>`);
                    }
                });
            }

            document.addEventListener("DOMContentLoaded", function () {
                $('#recent-sales-table').DataTable({
                    responsive: true,
                    fixedHeader: true,
                    processing: true,
                    serverSide: true,
                    paging: true,
                    scrollY: "400px",
                    scrollCollapse: true,
                                language: {
                lengthMenu: "@Localizer["home.datatable.LENGTH_MENU"]",
                search: "@Localizer["home.datatable.SEARCH"]",
                info: "@Localizer["home.datatable.INFO"]",
                infoEmpty: "@Localizer["home.datatable.INFO_EMPTY"]",
                infoFiltered: "@Localizer["home.datatable.INFO_FILTERED"]",
                loadingRecords: "@Localizer["home.datatable.LOADING"]",
                zeroRecords: "@Localizer["home.datatable.ZERO_RECORDS"]",
                emptyTable: "@Localizer["home.datatable.EMPTY_TABLE"]",
                paginate: {
                    first: "@Localizer["home.datatable.PAGINATE.FIRST"]",
                    last: "@Localizer["home.datatable.PAGINATE.LAST"]",
                    next: "@Localizer["home.datatable.PAGINATE.NEXT"]",
                    previous: "@Localizer["home.datatable.PAGINATE.PREVIOUS"]"
                },
                aria: {
                    sortAscending: "@Localizer["home.datatable.ARIA.SORT_ASC"]",
                    sortDescending: "@Localizer["home.datatable.ARIA.SORT_DESC"]"
                }
            },
              ajax: {
                url: (function () {
                    const culture = new URLSearchParams(window.location.search).get("culture") || "tr-TR";
                    const uiCulture = new URLSearchParams(window.location.search).get("ui-culture") || culture;
                    return '@Url.Action("GetSalesTable", "Home")' + `?culture=${culture}&ui-culture=${uiCulture}`;
                })(),
                type: 'GET',
                data: function (d) {
                    return d;
                },
                dataSrc: function (json) {
                    return json.data;
                }
            }
            ,
                    columns: [
                        {
                            data: 'customerName',
                            render: function (data, type, row) {
                                return `<img src="${row.avatar}" class="rounded-circle me-2" style="width: 32px; height: 32px; object-fit: cover;" />
                                        <span>${data}</span>`;
                            }
                        },
                        { data: 'orderId' },
                        { data: 'date' },
                        { data: 'totalPrice' },
                        { data: 'paymentMethod' },
                        {
                            data: 'status',
                            render: function (data) {
                                return `<span class="badge bg-success-transparent text-success">${data}</span>`;
                            }
                        },
                                                {
                data: 'orderId',
                orderable: false,
                searchable: false,
                render: function (orderId) {
                    return `
                        <div class="d-flex gap-2">
                            <button class="btn btn-sm btn-outline-primary" onclick="showSaleDetail(${orderId})">
                                <i class="fe fe-eye"></i> ${"@Localizer["home.INDEX.SHOW"]"}
                            </button>
                            <button class="btn btn-sm btn-outline-danger" onclick="cancelSale(${orderId})">
                                <i class="fe fe-x-circle"></i> ${"@Localizer["productSale.DETAIL.CANCEL_SALE"]"}
                            </button>
                        </div>
                    `;
                }
            }
                    ],
                    drawCallback: function () {
                        var popoverTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="popover"]'));
                        popoverTriggerList.map(function (popoverTriggerEl) {
                            return new bootstrap.Popover(popoverTriggerEl);
                        });
                    }
                });
            });
        </script>

        <!-- ApexCharts dynamic chart rendering with ViewBag.Stats -->
        <script>
                 const statValues = {
                monthlyReservation: @((int)Math.Clamp(ViewBag.Stats.MonthlyReservation.PercentOfPrevious, 0, 100)),
                dailyReservation: @((int)Math.Clamp(ViewBag.Stats.DailyReservation.PercentOfPrevious, 0, 100)),
                monthlyTicket: @((int)Math.Clamp(ViewBag.Stats.MonthlyTicket.PercentOfPrevious, 0, 100)),
                dailyTicket: @((int)Math.Clamp(ViewBag.Stats.DailyTicket.PercentOfPrevious, 0, 100))
            };

            // Monthly Reservation (total-orders)
            const totalOrdersChart = new ApexCharts(document.querySelector("#total-orders"), {
                chart: { height: 130, width: 100, type: "radialBar" },
                series: [statValues.monthlyReservation],
                colors: ["#b50d05"],
                plotOptions: {
                    radialBar: {
                        hollow: { margin: 0, size: "50%", background: "#fff" },
                        dataLabels: {
                            name: { show: false },
                            value: {
                                offsetY: 5,
                                color: "#4b9bfa",
                                fontSize: ".875rem",
                                show: true,
                                fontWeight: 600
                            }
                        }
                    }
                },
                stroke: { lineCap: "round" },
                labels: ["Status"]
            });
            document.querySelector("#total-orders").innerHTML = "";
            totalOrdersChart.render();

            // Daily Reservation (total-views)
            const totalViewsChart = new ApexCharts(document.querySelector("#total-views"), {
                chart: { height: 130, width: 100, type: "radialBar" },
                series: [statValues.dailyReservation],
                colors: ["#0a7326"],
                plotOptions: {
                    radialBar: {
                        hollow: { margin: 0, size: "50%", background: "#fff" },
                        dataLabels: {
                            name: { show: false },
                            value: {
                                offsetY: 5,
                                color: "#4b9bfa",
                                fontSize: ".875rem",
                                show: true,
                                fontWeight: 600
                            }
                        }
                    }
                },
                stroke: { lineCap: "round" },
                labels: ["Status"]
            });
            document.querySelector("#total-views").innerHTML = "";
            totalViewsChart.render();

            // Monthly Ticket (total-earnings)
            const totalEarningsChart = new ApexCharts(document.querySelector("#total-earnings"), {
                chart: { height: 130, width: 100, type: "radialBar" },
                series: [statValues.monthlyTicket],
                colors: ["#da4a25"],
                plotOptions: {
                    radialBar: {
                        hollow: { margin: 0, size: "50%", background: "#fff" },
                        dataLabels: {
                            name: { show: false },
                            value: {
                                offsetY: 5,
                                color: "#4b9bfa",
                                fontSize: ".875rem",
                                show: true,
                                fontWeight: 600
                            }
                        }
                    }
                },
                stroke: { lineCap: "round" },
                labels: ["Status"]
            });
            document.querySelector("#total-earnings").innerHTML = "";
            totalEarningsChart.render();

            // Daily Ticket (total-comments)
            const totalCommentsChart = new ApexCharts(document.querySelector("#total-comments"), {
                chart: { height: 130, width: 100, type: "radialBar" },
                series: [statValues.dailyTicket],
                colors: ["#3578d5"],
                plotOptions: {
                    radialBar: {
                        hollow: { margin: 0, size: "50%", background: "#fff" },
                        dataLabels: {
                            name: { show: false },
                            value: {
                                offsetY: 5,
                                color: "#4b9bfa",
                                fontSize: ".875rem",
                                show: true,
                                fontWeight: 600
                            }
                        }
                    }
                },
                stroke: { lineCap: "round" },
                labels: ["Status"]
            });
            document.querySelector("#total-comments").innerHTML = "";
            totalCommentsChart.render();
        </script>
}
