@using Microsoft.AspNetCore.Mvc.Localization
@inject IViewLocalizer Localizer
<!DOCTYPE html>
<html lang="en" dir="ltr" data-nav-layout="vertical" data-theme-mode="light" data-header-styles="gradient" data-menu-styles="light" data-toggled="close">

<head>
    <link href='https://fonts.googleapis.com/css?family=Lexend' rel='stylesheet'>
    @Html.Partial("~/Views/Shared/_title_meta.cshtml")
    @RenderSection("styles", required: false)
    @Html.Partial("~/Views/Shared/_head_css.cshtml")
</head>
<body>

    @Html.Partial("~/Views/Shared/_switcher.cshtml")
    <!-- Loader -->
    <div id="loader">
        <img src="../assets/images/media/loader.svg" alt="">
    </div>
    <!-- Loader -->

    <div class="page">
        @Html.Partial("~/Views/Shared/_header.cshtml")
        @Html.Partial("~/Views/Shared/_sidebar.cshtml")

        @RenderBody()
        @Html.Partial("~/Views/Shared/_footer.cshtml")
    </div>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- Choices JS -->
    <script src="../assets/libs/choices.js/public/assets/scripts/choices.min.js"></script>


    <script src="../assets/js/main.js"></script>

    <!-- Bootstrap Css -->
    <link id="style" href="../assets/libs/bootstrap/css/bootstrap.min.css" rel="stylesheet">


    <!-- Style Css -->
    <link href="../assets/css/styles.min.css" rel="stylesheet">
    <link href="../assets/css/custom-overrides.css" rel="stylesheet">

    <!-- Icons Css -->
    <link href="../assets/css/icons.css" rel="stylesheet">


    <!-- Scroll To Top -->
    <div class="scrollToTop">
        <span class="arrow"><i class="ri-arrow-up-s-fill fs-20"></i></span>
    </div>
    <div id="responsive-overlay"></div>
    <!-- Scroll To Top -->
    
    <!-- Global Loading Overlay -->
    <div id="globalLoadingOverlay" class="global-loading-overlay" style="display: none;">
        <div class="global-loading-content">
            <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">@Localizer["shared.LOADING"]</span>
            </div>
            <p class="mt-3 text-white" id="globalLoadingMessage">@Localizer["shared.LOADING_MESSAGE"]</p>
        </div>
    </div>
    <!-- Global Loading Overlay -->
    <!-- Popper JS -->
    <script src="../assets/libs/popperjs/core/umd/popper.min.js"></script>

    <!-- Bootstrap JS -->
    <script src="../assets/libs/bootstrap/js/bootstrap.bundle.min.js"></script>

    <!-- Jquery JS -->
    <!-- jQuery Validation Plugin -->
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.1/jquery.validate.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.15.1/additional-methods.min.js"></script>



    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@@tabler/icons-webfont@latest/dist/tabler-icons.min.css" />

    @* removed custom switcher to avoid Pickr errors *@
    <script src="../assets/js/custom.js"></script>



    <!-- Defaultmenu JS -->
    <script src="../assets/js/defaultmenu.min.js"></script>

    <!-- Node Waves JS-->
    <script src="../assets/libs/node-waves/waves.min.js"></script>

    <!-- Sticky JS -->
    <script src="../assets/js/sticky.js"></script>

    <!-- Simplebar JS -->
    <script src="../assets/libs/simplebar/simplebar.min.js"></script>
    <script src="../assets/js/simplebar.js"></script>

    @* removed color picker when switcher is hidden *@

    <!-- JSVector Maps JS -->
    <script src="../assets/libs/jsvectormap/js/jsvectormap.min.js"></script>

    <!-- JSVector Maps MapsJS -->
    <script src="../assets/libs/jsvectormap/maps/world-merc.js"></script>

    <!-- Apex Charts JS -->
    <script src="../assets/libs/apexcharts/apexcharts.min.js"></script>

    <script src="../assets/js/index-2.js"></script>


    @* <script src="../assets/js/apexcharts-column.js"></script> *@

    <!-- Sweetalerts JS -->
    <script src="../assets/libs/sweetalert2/sweetalert2.min.js"></script>
    @* <script src="../assets/js/sweet-alerts.js"></script> *@


    <!-- Datatables Cdn -->
    <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.datatables.net/responsive/2.3.0/js/dataTables.responsive.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/dataTables.buttons.min.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.print.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.6/pdfmake.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="https://cdn.datatables.net/buttons/2.2.3/js/buttons.html5.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>

    <!-- Internal Datatables JS -->
    <script src="../assets/js/datatables.js"></script>
    <script src="../assets/js/redirect.js"></script>

    <!-- Global Loading Overlay Styles -->
    <style>
        .global-loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(2px);
        }

        .global-loading-content {
            text-align: center;
            color: white;
        }

        .global-loading-content .spinner-border {
            border-width: 0.3rem;
        }
    </style>

    <!-- Global AJAX Loading Interceptor -->
    <script>
        (function() {
            'use strict';
            
            // Global loading overlay kontrolü
            const loadingOverlay = document.getElementById('globalLoadingOverlay');
            let activeRequests = 0;

            function showLoading() {
                if (loadingOverlay && activeRequests === 0) {
                    loadingOverlay.style.display = 'flex';
                }
                activeRequests++;
            }

            function hideLoading() {
                activeRequests--;
                if (activeRequests <= 0) {
                    activeRequests = 0;
                    if (loadingOverlay) {
                        loadingOverlay.style.display = 'none';
                    }
                }
            }

            // jQuery AJAX interceptor
            if (typeof jQuery !== 'undefined') {
                $(document).ajaxStart(function() {
                    showLoading();
                }).ajaxStop(function() {
                    hideLoading();
                }).ajaxError(function() {
                    hideLoading();
                });
            }

            // Fetch API interceptor
            const originalFetch = window.fetch;
            window.fetch = function(...args) {
                showLoading();
                return originalFetch.apply(this, args)
                    .finally(function() {
                        hideLoading();
                    });
            };

            // Global utility fonksiyonlar
            window.showGlobalLoading = function(customMessage) {
                if (customMessage && loadingOverlay) {
                    const messageEl = loadingOverlay.querySelector('#globalLoadingMessage');
                    if (messageEl) {
                        messageEl.textContent = customMessage;
                    }
                }
                showLoading();
            };
            window.hideGlobalLoading = hideLoading;
            
            // Loading mesajını localStorage'dan veya default olarak ayarla
            const defaultLoadingMessage = '@Localizer["shared.LOADING_MESSAGE"]';
        })();
    </script>

    @RenderSection("scripts", required: false)
</body>
</html>
